var webkit_DragManager={draggables:[],dropZones:[],addDraggable:function(n,t){this.draggables.push(new webkit_draggable(n,t))},removeDraggable:function(n){for(var t=0;t<this.draggables.length;t++)if(this.draggables[t].p.handle.id==n){this.draggables[t].destroy();break}},addDropZone:function(n,t){webkit_drop.add(n,t);this.dropZones.push(n)},reset:function(){for(var n=0;n<this.draggables.length;n++)this.draggables[n].destroy();for(this.draggables=[],n=0;n<this.dropZones.length;n++)webkit_drop.remove(this.dropZones[n].id);this.dropZones=[]}},webkit_tools={$:function(n){return typeof n=="string"?document.getElementById(n):n},extend:function(n,t){for(var i in t)n[i]=t[i];return n},empty:function(){},compact:function(n){for(var i=[],r=n.length,t=0;t<r;t++)n[t]!==null&&i.push(n[t]);return i},getCalculatedStyle:function(n,t){var i="";return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(n,"").getPropertyValue(t):n.currentStyle&&(t=t.replace(/\-(\w)/g,function(n,t){return t.toUpperCase()}),i=n.currentStyle[t]),i},bindAsEventListener:function(n,t){var i=n;return function(n){i.call(t,n||window.event)}},cumulativeOffset:function(n){var t=0,i=0;do{if(t+=n.offsetTop||0,i+=n.offsetLeft||0,n.offsetParent==document.body&&n.style.position=="absolute")break;n=n.offsetParent}while(n);return{left:i,top:t}},getDimensions:function(n){var i=n.style.display,u,f;if(i!="none"&&i!=null)return{width:n.offsetWidth,height:n.offsetHeight};var t=n.style,e=t.visibility,r=t.position,o=t.display;return t.visibility="hidden",r!="fixed"&&(t.position="absolute"),t.display="block",u=n.clientWidth,f=n.clientHeight,t.display=o,t.position=r,t.visibility=e,{width:u,height:f}},hasClassName:function(n,t){var i=n.className;return i.length>0&&(i==t||new RegExp("(^|\\s)"+t+"(\\s|$)").test(i))},addClassName:function(n,t){return this.hasClassName(n,t)||(n.className+=(n.className?" ":"")+t),n},removeClassName:function(n,t){return this.hasClassName(n,t)&&(n.className=this.strip(n.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," "))),n},strip:function(n){return n.replace(/^\s+/,"").replace(/\s+$/,"")}},webkit_droppables=function(){this.initialize=function(){this.droppables=[];this.droppableRegions=[]};this.add=function(n,t){n=webkit_tools.$(n);var i={accept:[],hoverClass:null,hoverAllDropZone:!1,onDrop:webkit_tools.empty,onOver:webkit_tools.empty,onOut:webkit_tools.empty,onAllOver:webkit_tools.empty,onAllOut:webkit_tools.empty};i=webkit_tools.extend(i,t||{});this.droppables.push({r:n,p:i})};this.remove=function(n){n=webkit_tools.$(n);for(var t=this.droppables,i=t.length;i--;)if(t[i].r==n)return t[i]=null,this.droppables=webkit_tools.compact(t),!0;return!1};this.prepare=function(){for(var i=this.droppables,t=i.length,r=[],n=null;t--;)n=i[t].r,n.style.display!="none"&&r.push({i:t,size:webkit_tools.getDimensions(n),offset:webkit_tools.cumulativeOffset(n),dropzone:n});this.droppableRegions=r};this.isIPad1=function(){return navigator.userAgent.indexOf("iPad")!=-1&&navigator.userAgent.indexOf("OS 5")!=-1?!0:!1};this.finalize=function(n,t,i,r,u){var f,h;this.lastIndex=undefined;var c=this.isOver(n,t),o=this.maxZIndex(c),s=this.process(o,i),e=this;return s?this.drop(o,i,u):(f=function(){var n;for(webkit_tools.addClassName(i,"release"),webkit_tools.removeClassName(i,"animatedfast"),webkit_tools.removeClassName(i,"shake"),webkit_tools.removeClassName(i,"droptransition"),i.setAttribute("style","top: "+r.ry+"px; left: "+r.rx+"px;"),e.process(-1,i),n=0;n<e.droppables.length;n++){var t=e.droppables[n],u=t.p,f=t.r;u.hoverClass&&webkit_tools.removeClassName(f,u.hoverClass)}setTimeout(function(){$("#mask").css("display","none")},500)},h=navigator.userAgent.indexOf("WebKit")!=-1,this.isIPad1()?setTimeout(f,200):h?(webkit_tools.addClassName(i,"animatedfast shake"),webkit_tools.addClassName(i,"droptransition"),i.addEventListener("webkitAnimationEnd",f,!1)):($(i).animate({left:"-=20"},20),setTimeout(function(){$(i).animate({left:"+=40"},20)},20),setTimeout(function(){$(i).animate({left:"-=40"},20)},40),setTimeout(function(){$(i).animate({left:"+=40"},20)},60),setTimeout(function(){$(i).animate({left:"-=20"},20)},80),setTimeout(function(){$(i).animate({left:r.rx,top:r.ry},500)},100),setTimeout(f,600)),$("#mask").css("display","block")),s};this.check=function(n,t,i){var r=this.isOver(n,t),u=this.maxZIndex(r);return this.process(u,i)};this.isOver=function(n,t){for(var f=this.droppableRegions,e=f.length,o=[],i=0,s=0,r=0,h=0,u=0,c;e--;)i=f[e],c=$(i.dropzone),u=c.offset().top,h=u+i.size.height,t>=u&&t<h&&(r=i.offset.left,r>=this.getParentOffset()&&(r=r-this.getParentOffset()),s=r+i.size.width,n>=r&&n<=s&&o.push(i.i));return o};this.getParentOffset=function(){return 0};this.maxZIndex=function(n){for(var f=this.droppables,t=n.length,r=-1,u=-1e8,i=0;t--;)i=parseInt(f[n[t]].r.style.zIndex||0),i>u&&(u=i,r=n[t]);return r};this.process=function(n,t){for(var u=0;u<this.droppables.length;u++){var r=this.droppables[u],i=r.p,f=r.r;i.hoverClass&&webkit_tools.removeClassName(f,i.hoverClass);i.hoverAllDropZone&&u==n&&webkit_tools.addClassName(f,i.hoverClass)}if(this.lastOutput=!1,this.lastIndex!=n){if(this.lastIndex!=null&&this.lastIndex!=-1){var r=this.droppables[this.lastIndex],i=r.p,f=r.r;i.onOut(t);i.onAllOut(t);this.lastIndex=null;this.lastOutput=!1}if(n!=-1){var r=this.droppables[n],i=r.p,f=r.r;if(this.isAccepted(t,i.accept)){i.hoverClass&&webkit_tools.addClassName(f,i.hoverClass);i.onOver(t);this.lastOutput=!0}t.id==i.accept&&(i.onOver(),this.lastOutput=!0);i.onAllOver(t)}this.lastIndex=n}return this.lastOutput};this.drop=function(n,t,i){if(n!=-1)this.droppables[n].p.onDrop(t,i)};this.hasClassNames=function(n,t){var i=t.length;if(i==0)return!0;while(i--)if(webkit_tools.hasClassName(n,t[i]))return!0;return!1};this.isAccepted=function(n,t){var i=t.length;if(i==0)return!1;while(i--)if(n.id==t[i])return!0;return!1};this.initialize()},webkit_draggable,webkit_click;webkit_drop=new webkit_droppables;webkit_draggable=function(n,t){this.isDragging=!1;this.initialize=function(n,t){this.root=webkit_tools.$(n);var i={scroll:!1,revert:!1,container:this.root,handle:this.root,zIndex:1e3,onStart:webkit_tools.empty,onEnd:webkit_tools.empty};this.p=webkit_tools.extend(i,t||{});i.handle=webkit_tools.$(i.handle);this.prepare();this.bindEvents()};this.prepare=function(){var n=this.root.style;webkit_tools.getCalculatedStyle(this.root,"position")!="absolute"&&(n.position="relative");n.top=n.top||"0px";n.left=n.left||"0px";n.right="";n.bottom="";n.zIndex=n.zIndex||"0"};this.bindEvents=function(){var n=this.p.handle,t=this.p.container,i=this;this.ts=webkit_tools.bindAsEventListener(this.touchStart,this);this.tm=webkit_tools.bindAsEventListener(this.touchMove,this);this.te=webkit_tools.bindAsEventListener(this.touchEnd,this);this.isTouchEnabled()?(n.addEventListener("touchstart",this.ts,!1),n.addEventListener("touchmove",this.tm,!1),n.addEventListener("touchend",this.te,!1)):n.addEventListener?(n.addEventListener("mousedown",this.ts,!1),t.addEventListener("mousemove",this.tm,!1),n.addEventListener("mouseup",this.te,!1)):n.attachEvent&&(n.attachEvent("onmousedown",this.ts),t.attachEvent("onmousemove",this.tm),n.attachEvent("onmouseup",this.te))};this.destroy=function(){var n=this.p.handle,t=this.p.container,i=this;window.navigator.msPointerEnabled?(n.removeEventListener("MSPointerDown",this.ts),n.removeEventListener("MSPointerMove",this.tm),n.removeEventListener("MSPointerUp",this.te)):this.isTouchEnabled()?(n.removeEventListener("touchstart",this.ts),n.removeEventListener("touchmove",this.tm),n.removeEventListener("touchend",this.te)):n.removeEventListener?(n.removeEventListener("mousedown",this.ts,!1),t.removeEventListener("mousemove",this.tm,!1),n.removeEventListener("mouseup",this.te,!1)):n.detachEvent&&(n.detachEvent("onmousedown",this.ts),t.detachEvent("onmousemove",this.tm),n.detachEvent("onmouseup",this.te))};this.isTouchEnabled=function(){var n=navigator.userAgent.indexOf("iPhone")!=-1||navigator.userAgent.indexOf("iPad")!=-1||(navigator.platform.indexOf("Mac")!=-1&&navigator.maxTouchPoints>1)||navigator.userAgent.indexOf("iPod")!=-1,t=navigator.userAgent.indexOf("Android")!=-1;return n||t};this.set=function(n,t){this.p[n]=t};this.getEvent=function(n){return n.targetTouches?n.targetTouches[0]:n};this.getPageX=function(n){return n.pageX?n.pageX:n.clientX};this.getPageY=function(n){return n.pageY?n.pageY:n.clientY};this.getPosition=function(){var n=this.root.style;return{x:parseInt(n.left||0),y:parseInt(n.top||0)}};this.touchStart=function(n){var e,u;if(!this.isDragging&&n){var t=this.p,i=this.root,r=i.style,f=this.getEvent(n);this.isDragging=!0;webkit_tools.removeClassName(i,"release");webkit_tools.removeClassName(i,"animatedfast");webkit_tools.removeClassName(i,"shake");webkit_tools.removeClassName(i,"droptransition");touchX=this.getPageX(f);touchY=this.getPageY(f);r.top=this.root.style.top||"0px";r.left=this.root.style.left||"0px";r.bottom=null;r.right=null;e=webkit_tools.cumulativeOffset(i);u=this.getPosition();t.rx=u.x;t.ry=u.y;t.tx=touchX;t.ty=touchY;t.z=parseInt(this.root.style.zIndex);r.zIndex=t.zIndex;webkit_drop.prepare();t.onStart(i)}};this.touchMove=function(n){var f;if(this.isDragging&&n){n.preventDefault?n.preventDefault():(n.returnValue=!1,n.cancelBubble=!0);n.stopPropagation&&n.stopPropagation();var t=this.p,e=this.root,o=e.style,u=this.getEvent(n);if(u==null)return;var i=this.getPageX(u),r=this.getPageY(u),c=i-t.tx,l=r-t.ty,h=t.rx+c;isNaN(h)||(o.left=h+"px");f=t.ry+l;isNaN(f)||(o.top=f+"px");t.scroll&&(s=this.getScroll(i,r),(s[0]!=0||s[1]!=0)&&window.scrollTo(window.scrollX+s[0],window.scrollY+s[1]));webkit_drop.check(i,r,e,t);this.lastCurX=i;this.lastCurY=r}};this.touchEnd=function(n){if(n){this.isDragging=!1;var t=this.root,i=this.p,r=webkit_drop.finalize(this.lastCurX,this.lastCurY,t,i,n);isNaN(this.p.z)&&(this.p.z=0);t.style.zIndex=this.p.z;this.p.onEnd(t)}};this.getScroll=function(n,t){var e=window.scrollX,o=window.scrollY,s=window.innerWidth,h=window.innerHeight,i=10,r=100,u=0,f=0;return t-o<r?f=-i:o+h-t<r&&(f=i),n-e<r?u=-i:e+s-n<r&&(u=i),[u,f]};this.initialize(n,t)};webkit_click=function(n,t){this.initialize=function(n,t){var i={onClick:webkit_tools.empty};this.root=webkit_tools.$(n);this.p=webkit_tools.extend(i,t||{});this.bindEvents()};this.bindEvents=function(){var n=this.root;this.ts=webkit_tools.bindAsEventListener(this.touchStart,this);this.tm=webkit_tools.bindAsEventListener(this.touchMove,this);this.te=webkit_tools.bindAsEventListener(this.touchEnd,this);n.addEventListener("touchstart",this.ts,!1);n.addEventListener("touchmove",this.tm,!1);n.addEventListener("touchend",this.te,!1);this.bound=!0};this.touchStart=function(){this.moved=!1;this.bound==!1&&(this.root.addEventListener("touchmove",this.tm,!1),this.bound=!0)};this.touchMove=function(){this.moved=!0;this.root.removeEventListener("touchmove",this.tm);this.bound=!1};this.touchEnd=function(){this.moved==!1&&this.p.onClick()};this.setEvent=function(n){typeof n=="function"&&(this.p.onClick=n)};this.unbind=function(){var n=this.root;n.removeEventListener("touchstart",this.ts);n.removeEventListener("touchmove",this.tm);n.removeEventListener("touchend",this.te)};this.initialize(n,t)};
//# sourceMappingURL=webkitdragdrop.min.js.map
